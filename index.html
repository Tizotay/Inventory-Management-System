inventory.push(item);
            updateInventoryTable();
            checkLowStock();
            updateTotalInventoryValue();
            document.getElementById('item-form').reset();
        }

        function updateInventoryTable() {
            const tableBody = document.getElementById('inventory-table').querySelector('tbody');
            tableBody.innerHTML = '';

            inventory.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.id}</td>
                    <td>${item.name}</td>
                    <td>${item.category}</td>
                    <td>${item.quantity}</td>
                    <td>RM ${item.price.toFixed(2)}</td>
                    <td>RM ${item.totalValue.toFixed(2)}</td>
                    <td>
                        <button onclick="sellItem(${index})">Sell</button>
                        <button onclick="addStock(${index})">Add Stock</button>
                        <button onclick="removeItem(${index})">Remove</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function saveInventory() {
            if (currentUser) {
                localStorage.setItem(`${currentUser.companyName}-inventory`, JSON.stringify(inventory));
                alert('Inventory saved successfully!');
            } else {
                alert('Error: No user logged in.');
            }
        }

        function checkLowStock() {
            const lowStockList = document.getElementById('low-stock-list');
            lowStockList.innerHTML = '';

            inventory.forEach(item => {
                if (item.quantity < 10) {
                    const listItem = document.createElement('li');
                    listItem.textContent = ${item.name} (Category: ${item.category}) - Quantity: ${item.quantity};
                    lowStockList.appendChild(listItem);
                }
            });
        }

        function updateTotalInventoryValue() {
            const totalValue = inventory.reduce((sum, item) => sum + item.totalValue, 0);
            document.getElementById('total-inventory-value').textContent = RM ${totalValue.toFixed(2)};
        }
    </script>
</body>
</html>
